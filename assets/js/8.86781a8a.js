(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{377:function(t,s,a){t.exports=a.p+"assets/img/AsyncAndDefer.244a0c32.jpg"},391:function(t,s,a){"use strict";a.r(s);var n=a(43),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h3",{attrs:{id:"html-中的-script-标签"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#html-中的-script-标签"}},[t._v("#")]),t._v(" HTML 中的 Script 标签")]),t._v(" "),n("ol",[n("li",[n("p",[n("strong",[t._v("<script>元素")])]),t._v(" "),n("p",[t._v("HTML 中引入 JavaScript 脚本的主要方法通过<script>标签, 此标签有如下常见属性:")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("async")])])]),t._v(" "),n("p",[t._v("此属性表示立即下载脚本,但不阻塞其他页面动作. 例如下载 CSS、Image 以及其他脚本加载. 但只对外部引入脚本有效")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("defer")])])]),t._v(" "),n("p",[t._v("此属性表示文档解析和显示完成后再执行. 也是只对外部引入脚本有效")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("src")])])]),t._v(" "),n("p",[t._v("此属性表示引入 Js 脚本资源地址, 地址可以是相对路径或是网络请求地址")]),t._v(" "),n("div",{staticClass:"language-html line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("./example.js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}}),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.demo.com/example.js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}}),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])]),n("ul",[n("li",[n("strong",[t._v("type")])])]),t._v(" "),n("p",[t._v("此时属性代表代码块中脚本语言内容的类型(MIME 类型) 例如 以前经常添加的 text/javascript 后面有添加了 module 类型 值为 module 后, 代码就支持 ES6 的模块化了,即支持 export 和 import")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("<script>的使用方式")])]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("嵌入行内")])])]),t._v(" "),n("div",{staticClass:"language-html line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("doc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dosomething...")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),n("p",[t._v("在行内代码中最好不出现"),t._v("字符串, 将会导致浏览器报错. 当然也有解决办法, 通过转义字符即可: <\/script>")])]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("外部引入")])])]),t._v(" "),n("p",[t._v("外部引入就必须使用 src 属性 通过资源地址引入外部脚本.")]),t._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[t._v("要点")]),t._v(" "),n("ol",[n("li",[t._v("<\\script>标签会阻塞页面(在标签属性没有 async 或 defer 时)")]),t._v(" "),n("li",[t._v("外部引入脚本和嵌入行内同时存在, 将会忽略行内代码.")]),t._v(" "),n("li",[t._v("外部引入脚本不受同源策略限制,即可以跨域请求脚本资源")]),t._v(" "),n("li",[t._v("标签摆放的位置最好是放在 body 的最后面,而不是 head 标签里面, 因为放在 head 里会导致页面在一定时间完全空白\n也是因为要点 1 的特性导致的, 当然你也可以使用 async 或 defer 属性来异步请求资源.")])])]),t._v(" "),n("ul",[n("li",[n("p",[n("strong",[t._v("动态加载")]),t._v("\n通过 Javascript 的 DOM API 动态的添加 script 标签")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" script "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"script"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nscript"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"example.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndocument"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("head"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("script"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("p",[t._v("一般动态添加脚本都是异步, 要动态添加 async 属性, 但是 async 属性不是所有浏览器都支持,\n设置同步也可能影响获取资源的优先级以及影响性能的可能性. 可以通过以下代码使浏览器知道哪些是动态请求文件")]),t._v(" "),n("div",{staticClass:"language-html line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("preload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("example.js"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])])])])])]),t._v(" "),n("ol",{attrs:{start:"3"}},[n("li",[n("strong",[t._v("async 与 defer 的异同")])])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("共同点")]),t._v(" "),n("ul",[n("li",[t._v("两者都只对外部引入资源有效")]),t._v(" "),n("li",[t._v("都是立刻下载")])])]),t._v(" "),n("li",[n("p",[t._v("不同点")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("加载时机不同")]),t._v(" "),n("p",[n("strong",[t._v("defer")]),t._v(": 脚本在执行的时候不会改变页面的结构, 他会让浏览器立刻加载,但是推迟执行")]),t._v(" "),n("p",[n("strong",[t._v("async")]),t._v(": 让浏览器不必等脚本下载和执行完后加载页面或加载其他脚本")])]),t._v(" "),n("li",[n("p",[t._v("执行顺序")]),t._v(" "),n("p",[n("strong",[t._v("defer")]),t._v(": 多个 defer 执行属性是自上而下顺序")]),t._v(" "),n("p",[n("strong",[t._v("async")]),t._v(": 多个 async 不能保证执行顺序(最好不要修改 DOM 有风险)")]),t._v(" "),n("p",[t._v("如下图 async 和 defer 以及无两者属性的执行顺序:")]),t._v(" "),n("p",[n("img",{attrs:{src:a(377),alt:"Async与Defer比较"}})])])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);